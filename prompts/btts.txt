Objetivo: validar "BTTS - Si" (ambos equipos marcan).

Usa solo el Resumen historico y las Tendencias (Trends). No uses modelo ni datos externos.

Metodologia
1) Validar muestra
- Usa local/visitante.samples.goals (o matches si no existe).
- Si ambos < min_sample y no hay h2h con muestra suficiente, responde False.

2) Señales base (por equipo)
- rates.team_scored (capacidad de marcar).
- rates.team_conceded (propension a conceder).
- rates.btts (historial directo).
- averages.total_goals (ritmo general).

3) Contexto local/visita
- Si existen local_home y visitante_away, verifica que no contradigan.
- Si un bloque de contexto cae muy bajo (btts < 0.45 o team_scored < 0.60), penaliza fuerte.

4) Rachas
- Revisa streaks.btts.zero_streak.
- Si zero_streak >= 3 en algun equipo, es señal roja.

5) H2H (si existe)
- Si h2h.rates.btts >= 0.60 con muestra suficiente, puede elevar un caso borderline.

Reglas de decision
Devuelve True si se cumplen TODAS:
- local.rates.team_scored >= 0.70 y visitante.rates.team_scored >= 0.70
- local.rates.team_conceded >= 0.55 y visitante.rates.team_conceded >= 0.55
- (local.rates.btts >= 0.55 o visitante.rates.btts >= 0.55)
- averages.total_goals >= 2.2 en al menos uno de los equipos
- streaks.btts.zero_streak <= 2 en ambos
- y el contexto local_home/visitante_away no contradice

Devuelve False si se cumple ALGUNA:
- zero_streak >= 3 en algun equipo
- rates.btts <= 0.40 en ambos
- rates.team_scored <= 0.55 en alguno
- averages.total_goals < 2.0 en ambos

Si hay datos insuficientes o señales contradictorias, responde False.

Responde solo True o False.
